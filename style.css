// Questions divided into levels
const levels = {
  Easy: [
    { q: "Can plastic bottles be recycled?", a: "Yes" },
    { q: "Can used tissue paper be recycled?", a: "No" },
    { q: "Can food waste be composted?", a: "Yes" },
    { q: "Is mixing wet and dry waste a good practice?", a: "No" },
    { q: "Can metal cans be recycled?", a: "Yes" },
    { q: "Are plastic bags recyclable everywhere?", a: "No" },
    { q: "Can cardboard be recycled?", a: "Yes" },
    { q: "Can broken glass be recycled?", a: "Yes" }
  ],
  Medium: [
    { q: "Can batteries be recycled?", a: "Yes" },
    { q: "Is e-waste harmful to the environment?", a: "Yes" },
    { q: "Can newspapers be recycled?", a: "Yes" },
    { q: "Can thermocol be recycled easily?", a: "No" },
    { q: "Is composting eco-friendly?", a: "Yes" },
    { q: "Can oily paper be recycled?", a: "No" },
    { q: "Can aluminium foil be recycled?", a: "Yes" },
    { q: "Can old clothes be recycled or reused?", a: "Yes" },
    { q: "Is plastic biodegradable?", a: "No" }
  ],
  Hard: [
    { q: "Is burning waste a good idea?", a: "No" },
    { q: "Can mobile phones be recycled?", a: "Yes" },
    { q: "Can food waste go into a dry waste bin?", a: "No" },
    { q: "Is waste segregation important?", a: "Yes" },
    { q: "Can glass bottles be reused?", a: "Yes" },
    { q: "Is recycling good for the environment?", a: "Yes" },
    { q: "Can electronic waste be thrown in dustbin?", a: "No" },
    { q: "Is proper waste management necessary?", a: "Yes" }
  ]
};

let levelNames = ["Easy","Medium","Hard"];
let currentLevel = 0;
let index = 0;
let score = 0;
let timeLeft = 15;
let timer;

// Beep sound
function beep(){
  const context = new (window.AudioContext || window.webkitAudioContext)();
  const o = context.createOscillator();
  const g = context.createGain();
  o.type = "sine";
  o.connect(g);
  g.connect(context.destination);
  o.start(0);
  g.gain.exponentialRampToValueAtTime(0.00001, context.currentTime + 0.2);
  o.stop(context.currentTime + 0.2);
}

// Start Game
function startGame() {
  currentLevel = 0;
  score = 0;
  index = 0;
  document.getElementById("score").innerText = "Score: 0";
  document.getElementById("levelName").innerText = "Level: " + levelNames[currentLevel];
  document.getElementById("startBtn").style.display = "none";
  document.getElementById("buttons").style.display = "block";
  document.getElementById("nextLevelBtn").style.display = "none";
  document.getElementById("restartBtn").style.display = "none";
  document.getElementById("result").innerText = "";
  showQuestion();
  startTimer();
}

// Show question
function showQuestion() {
  document.getElementById("question").innerText = levels[levelNames[currentLevel]][index].q;
  resetTimer();
}

// Timer
function resetTimer() {
  clearInterval(timer);
  timeLeft = 15;
  document.getElementById("timer").innerText = "Time left: " + timeLeft;
  timer = setInterval(() => {
    timeLeft--;
    document.getElementById("timer").innerText = "Time left: " + timeLeft;
    if(timeLeft === 0){
      clearInterval(timer);
      nextQuestion();
    }
  },1000);
}

function startTimer(){
  resetTimer();
}

// Handle answer
function answer(choice){
  clearInterval(timer);
  let currentQ = levels[levelNames[currentLevel]][index];
  if(choice === currentQ.a){
    score++;
    document.getElementById("result").innerText = "‚úÖ Correct!";
  } else {
    document.getElementById("result").innerText = "‚ùå Wrong!";
  }
  beep();
  document.getElementById("score").innerText = "Score: " + score;
  setTimeout(nextQuestion, 700);
}

function nextQuestion(){
  index++;
  if(index < levels[levelNames[currentLevel]].length){
    showQuestion();
  } else {
    // End of level
    document.getElementById("buttons").style.display = "none";
    if(currentLevel < levelNames.length - 1){
      document.getElementById("nextLevelBtn").style.display = "inline-block";
      document.getElementById("result").innerText = "Level Completed! Click Next Level.";
    } else {
      endGame();
    }
  }
}

// Go to next level
function nextLevel(){
  currentLevel++;
  index = 0;
  document.getElementById("levelName").innerText = "Level: " + levelNames[currentLevel];
  document.getElementById("buttons").style.display = "block";
  document.getElementById("nextLevelBtn").style.display = "none";
  document.getElementById("result").innerText = "";
  showQuestion();
  startTimer();
}

// Restart game
function restartGame(){
  document.getElementById("restartBtn").style.display = "none";
  startGame();
}

// End game
function endGame(){
  document.getElementById("question").innerText = "üéâ Game Finished!";
  document.getElementById("result").innerText = "Final Score: " + score + " / 25";
  document.getElementById("buttons").style.display = "none";
  document.getElementById("timer").innerText = "";
  document.getElementById("restartBtn").style.display = "inline-block";
  document.getElementById("nextLevelBtn").style.display = "none";
  document.getElementById("levelName").innerText = "";
}
